-- 1
SELECT c.city, SUM(o.total_amount) AS total_sales
FROM (
    SELECT customer_id, total_amount
    FROM orders
    WHERE order_date >= '2023-01-01'
      AND order_date <  '2024-01-01'
) o
JOIN customer c ON c.customer_id = o.customer_id
GROUP BY c.city
ORDER BY total_sales DESC;

-- 2
SELECT p.name, t.total_sold
FROM (
    SELECT product_id, SUM(quantity) AS total_sold
    FROM order_item
    GROUP BY product_id
) t
JOIN product p ON p.product_id = t.product_id
ORDER BY t.total_sold DESC
LIMIT 10;

-- 3
SELECT order_id, order_date, total_amount
FROM orders
WHERE customer_id = 5000
ORDER BY order_date DESC
LIMIT 10;

--4
SELECT o.order_id, o.total_amount, c.name
FROM orders o
JOIN customer c ON c.customer_id = o.customer_id
ORDER BY o.total_amount DESC
LIMIT 20;

--5
WHERE order_date >= now() - interval '30 days';
Evitar funci√≥n sobre columna indexada:

--6
SELECT order_id, total_amount
FROM orders
WHERE customer_id = 12345
ORDER BY total_amount DESC
LIMIT 5;
